***REMOVED***{"id":"2e1170f91599e528","type":"tab","label":"one time access for visitors","disabled":false,"info":"","env":***REMOVED******REMOVED***},{"id":"80ba4a03259462fd","type":"2nac-access-log","z":"2e1170f91599e528","filter":"{\"category\":\"Granted\"}","name":"","filtertype":"json","x":200,"y":220,"wires":***REMOVED******REMOVED***"98870d1ca58de779"***REMOVED******REMOVED***},{"id":"d16f92f64af7cc37","type":"2nac-rest-api","z":"2e1170f91599e528","name":"end validity","method":"PATCH","endpoint":"visitors/{visitorId}","query":"","senderr":true,"x":650,"y":220,"wires":***REMOVED******REMOVED******REMOVED******REMOVED***},{"id":"21f320fc21a2a596","type":"function","z":"2e1170f91599e528","name":"getVisitorId","func":"var time = new Date().toLocaleString()\nmsg.visitorId = msg.payload.Person.Id\nmsg.body = ***REMOVED***{\"op\":\"replace\",\"path\":\"/VisitTo\",\"value\":time},{\"op\":\"replace\",\"path\":\"/IsSuspended\",\"value\":true}***REMOVED***\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":***REMOVED******REMOVED***,"x":490,"y":220,"wires":***REMOVED******REMOVED***"d16f92f64af7cc37"***REMOVED******REMOVED***},{"id":"98870d1ca58de779","type":"switch","z":"2e1170f91599e528","name":"isVisitor?","property":"payload.Person.IsVisitor","propertyType":"msg","rules":***REMOVED***{"t":"true"}***REMOVED***,"checkall":"true","repair":false,"outputs":1,"x":340,"y":220,"wires":***REMOVED******REMOVED***"21f320fc21a2a596"***REMOVED******REMOVED***}***REMOVED***